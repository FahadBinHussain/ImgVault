<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ImgVault</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <!-- No Image State -->
  <div id="noImageView" class="view">
    <div class="header">
      <div class="logo">ğŸ“¦</div>
      <div class="header-content">
        <h2>ImgVault</h2>
        <p>Your personal image vault</p>
      </div>
      <button id="galleryBtn" class="icon-btn" title="View Gallery">ğŸ–¼ï¸</button>
      <button id="settingsBtn" class="icon-btn" title="Settings">âš™ï¸</button>
    </div>
    
    <div class="empty-state">
      <div class="empty-icon">ğŸ–¼ï¸</div>
      <h3>No Image Selected</h3>
      <p>Right-click any image on a webpage and select "Save to ImgVault" to get started</p>
    </div>
  </div>

  <!-- Image Upload View -->
  <div id="imageView" class="view" style="display: none;">
    <div class="header">
      <div class="logo">ğŸ“¦</div>
      <div class="header-content">
        <h2>Save to Vault</h2>
        <p>Preserve with context</p>
      </div>
      <button id="settingsBtn" class="icon-btn" title="Settings">âš™ï¸</button>
    </div>
    
    <div class="image-preview">
      <img id="previewImage" alt="Preview">
    </div>
    
    <div class="form-section">
      <div class="form-group">
        <label>ğŸ“ Source Image URL</label>
        <div class="url-display" id="sourceUrlDisplay"></div>
      </div>
      
      <div class="form-group">
        <label>ğŸŒ Page URL</label>
        <div class="input-group">
          <input type="text" id="pageUrlInput" readonly placeholder="https://...">
          <button id="editPageUrlBtn" class="icon-btn" title="Edit">âœï¸</button>
        </div>
      </div>
      
      <div class="form-group">
        <label>ğŸ“ Notes (Optional)</label>
        <textarea id="notesInput" placeholder="Add your notes about this image..."></textarea>
      </div>
      
      <div class="form-group">
        <label>ğŸ·ï¸ Tags (Optional)</label>
        <input type="text" id="tagsInput" placeholder="design, inspiration, reference">
      </div>
      
      <div id="statusMessage" class="status" style="display: none;"></div>
      
      <button id="uploadBtn" class="btn btn-primary">
        ğŸš€ Upload to ImgVault
      </button>
    </div>
  </div>

  <!-- Success View -->
  <div id="successView" class="view" style="display: none;">
    <div class="header">
      <div class="logo">ğŸ“¦</div>
      <div class="header-content">
        <h2>ImgVault</h2>
        <p>Successfully saved</p>
      </div>
      <button id="settingsBtn" class="icon-btn" title="Settings">âš™ï¸</button>
    </div>
    
    <div class="success-state">
      <div class="success-icon">âœ“</div>
      <h3>Image Saved!</h3>
      <p>Your image has been securely stored in your vault with full context metadata</p>
      
      <div class="stored-url">
        <strong>Stored at:</strong><br>
        <a id="storedUrlLink" href="#" target="_blank"></a>
      </div>
      
      <div class="button-group">
        <button id="copyUrlBtn" class="btn btn-secondary">ğŸ“‹ Copy URL</button>
      </div>
    </div>
  </div>

  <!-- Settings View -->
  <div id="settingsView" class="view" style="display: none;">
    <div class="header">
      <button id="backToImageBtn" class="icon-btn">â†</button>
      <div class="header-content">
        <h2>Settings</h2>
        <p>Configure your vault</p>
      </div>
    </div>
    
    <div class="form-section">
      <div class="settings-section">
        <h3>ğŸ–¼ï¸ Pixvid API</h3>
        <p class="help-text">Pixvid hosts your images permanently. Get your API key from <a href="https://pixvid.org/settings/api" target="_blank">pixvid.org/settings/api</a></p>
        
        <div class="form-group">
          <label>API Key</label>
          <input type="password" id="apiKeyInput" placeholder="Enter your Pixvid API key">
        </div>
      </div>

      <div class="settings-section">
        <h3>ğŸ”¥ Firebase Configuration</h3>
        <p class="help-text">Firebase Firestore stores your image metadata securely in the cloud. Get your config from the <a href="https://console.firebase.google.com" target="_blank">Firebase Console</a></p>
        
        <div class="form-group">
          <label>Paste Firebase Config</label>
          <textarea id="firebaseConfigPaste" rows="10" placeholder='const firebaseConfig = {
  apiKey: "AIza...",
  authDomain: "your-app.firebaseapp.com",
  projectId: "your-project",
  storageBucket: "your-app.appspot.com",
  messagingSenderId: "123456789",
  appId: "1:123456789:web:abc123"
};'></textarea>
          <small>Paste your entire Firebase config object from Firebase Console â†’ Project Settings</small>
        </div>
      </div>
      
      <button id="saveSettingsBtn" class="btn btn-primary">
        ğŸ’¾ Save Configuration
      </button>
    </div>
  </div>

  <!-- Gallery View -->
  <div id="galleryView" class="view" style="display: none;">
    <div class="header">
      <button id="backFromGalleryBtn" class="icon-btn">â†</button>
      <div class="header-content">
        <h2>Image Vault</h2>
        <p id="galleryCount">Loading...</p>
      </div>
      <button id="refreshGalleryBtn" class="icon-btn" title="Refresh">ğŸ”„</button>
    </div>
    
    <div id="galleryGrid" class="gallery-grid">
      <!-- Images will be loaded here -->
    </div>
    
    <div id="galleryEmpty" class="empty-state" style="display: none;">
      <div class="empty-icon">ğŸ“­</div>
      <h3>No Images Saved</h3>
      <p>Start saving images to build your vault</p>
    </div>
  </div>

  <!-- Load scripts -->
  <script src="storage.js"></script>
  <script src="popup.js"></script>
</body>
</html>
